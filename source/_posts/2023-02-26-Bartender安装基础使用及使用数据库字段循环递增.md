---
title: Bartender安装基础使用及使用数据库字段循环递增
categories:
  - 默认
date: 2023-02-26 21:59:43
updated:
top:
tags:
description:
keywords:
comments:
image:
---
无格式迁移
<!--more-->

第一次使用标签打印机，得力送的Bartender lite版本，无法链接数据库，遂下载官方2016版本，特殊地区无法连接到官方服务器，安装失败，直接使用完整版本的2019 r5安装包，打个补丁，没办法只能用了。只做测试学习使用，以后真要大量用再补票吧。

安装
在某外网搜索关键字，找到2019 R5版本，和补丁。执行安装程序后会有很大的延迟时间才弹出窗口，不知道是不是虚拟机的原因。无脑安装完整版，注册补丁解压到Bt的安装根目录，执行补丁程序（日常管理员权限执行），点击补丁窗口中间的一排蓝字。

安装完成

连接打印机
打印机注意事项
DL-888t支持最大碳带宽度为110mm，最小为33.8mm，长度为90m，碳带卷芯内径为12.7mm，碳带为双轴，纸张最大也是110mm
定位块（黑色的滑块），要对准边缘的三角形标记
打印机首选项-》页面设置-》新建-》名称改为数字（不能为中文），标签大小按照实际标签设置。
配套的打印机设置工具中要添加打印机（不能使用默认的Auto），设置打印机按钮选项卡需要吧模式选择为对应的打印模式，热敏模式必须把碳带取出。
BT连接注意
bt打印中纸张也要选择实际大小否则可能会连续出纸

BT连接数据库（excel）
简单，网上大把教程，且根据日常操作逻辑就可以成功连接excel，唯一值得注意的是，需要使用office 2006之后版本创建的xls文件。

使用数据库字段循环递增
BT模板使用数据库中的字段已经很简单了，但是实现这个递增还是挺难的（对我来说），我尝试使用Bt支持的vb来实现，但是功底太差实现不了，唯一能想出的解决办法，就是使用脚本直接把表格数据序列化，然后直接使用数据库中的字段。但是这太傻了。

最后在群里大佬花了几分钟给解决了。请大佬喝杯咖啡，然后把模板文件拿来研究。

由于使用的非官方BT，大佬的模板过来直接连接不了数据库，尝试安装了AccessDatabaseEngine_X64.exe就成功打开了。

需求
要实现如图的把数量，按照数量的份数打印，然后每一份按照编号递增

img

456

实现
不需要使用VB，直接使用软件原生的序列化即可实现。

把文本的属性直接如下设置：

IMG_20200530_172006

IMG_20200530_172014

IMG_20200530_172021

IMG_20200530_172028

治疗颈椎病从我做起

大致的逻辑过程就是：序列号是一个队列，队列打印完了，一行数据就循环完毕，开始第二行，序号改变，数据重置为1，开始循环打印第二行。。。。。