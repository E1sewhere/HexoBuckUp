---
title: 探索渗透测试流程
categories:
  - 默认
date: 2019-03-23 15:08:00
updated:
tags:
description:
keywords:
comments:
image:
---

<!--more-->


# clip
ip=="37.105.212.151"
title="【58同城 58.com】北京分类信息 - 本地 免费 高效"
subDomainsBrute  not gevent?
 pip install gevent
nslookup domain //总是返回一个ip,感觉不靠谱
google insite:
 https://zhuanlan.zhihu.com/p/33440472 

# 58同城
## 信息收集
### 域名信息收集
使用whois命令
或者使用[whois站长工具](http://whois.chinaz.com/)

```
域名
58.com[whois 反查] 申请删除隐私

其他常用域名后缀查询： cn com cc net org

注册商 eName Technology Co., Ltd
联系邮箱abuse@ename.com[whois反查]
联系电话*******44400[whois反查]
创建时间1998年07月10日
过期时间2028年07月09日
域名服务器whois.ename.com
DNSNS3.DNSV5.COM
NS4.DNSV5.COM
-------站长之家 Whois查询--------

````kali whois````
Domain Name: 58.com
Registry Domain ID: 3833625_DOMAIN_COM-VRSN
Registrar WHOIS Server: whois.ename.com
Registrar URL: http://www.ename.net
Updated Date: 2018-12-07T07:19:17Z
Creation Date: 1998-07-10T04:00:00Z
Registrar Registration Expiration Date: 2028-07-09T04:00:00Z
Registrar: eName Technology Co.,Ltd.
Registrar IANA ID: 1331
Registrar Abuse Contact Email: abuse@ename.com
Registrar Abuse Contact Phone: +86.4000044400
Domain Status: clientDeleteProhibited https://www.icann.org/epp#clientDeleteProhibited
Domain Status: clientTransferProhibited https://www.icann.org/epp#clientTransferProhibited
Domain Status: clientUpdateProhibited https://www.icann.org/epp#clientUpdateProhibited

```



### 子域名
按照网上的基本思路是找到子域名,子域名如果没有cdn就可以找到主站的ip

在线的服务用云栖扫了下,半天没出结果.
用:https://x.threatbook.cn/ 倒是很快,但是要看全部信息,需要注册,积分之类的,上百个子域名.

本次使用`layer子域名挖掘机`



```
域名	解析IP	开放端口	WEB服务器	网站状态
mail.58.com	112.90.77.178,112.90.78.157	80,443		80:正常访问
img1.58.com	101.206.209.227	80,443	ImgHttp3.0.0	80:正常访问
broker.58.com	154.8.240.86	80,443	Tengine	80:正常访问
bugs.58.com	115.159.231.65	80,443	Tengine	80:正常访问
data.58.com	154.8.240.21	80,443	Tengine	80:正常访问
dk.58.com	154.8.240.21	80,443	Tengine	80:正常访问  //多地ping 154.8.240.21
...省略....
```



直接多地ping,看了下不少子域名都没有cdn,但是主域名应该有cdn,会返回多个ip,过了半天再ping,主域名又返回一致的ip `115.159.231.141`就像没有cdn一样,简直玄学....
网上查的几种绕过cdn的方法,不太好实践.

发现一个帖子,尝试了使用fofa,获取了 http://www.5173.com的ip,直接用ip访问试一试,进入了5173的主站,应该是直接跑在物理机上.用nmap 扫端口除了80全是过滤状态的端口.
windows server iis. 试了几个发送get请求的地方没试出来sqli.继续看58这边

站长工具多地ping ip直接查看到这个子域名,没有cdn.
union.58.com	115.159.231.144	80,443	Tengine	80:正常访问

对其使用`nmap -sP union.58.com/24`
扫描c段,存活主机

```
一大段省略了....
```


使用`nmap -sS -p- -v union.58.com`
扫描全存活端口

```
PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  https
843/tcp open  unknown
```
又用 -u参数扫了下,结果一样.


### 服务器信息
使用`nmap -O union.58.com`获取操作系统信息

```
Running: Actiontec embedded, Linux 2.4.X|3.X
OS CPE: cpe:/h:actiontec:mi424wr-gen3i cpe:/o:linux:linux_kernel cpe:/o:linux:linux_kernel:2.4.37 cpe:/o:linux:linux_kernel:3.2
OS details: Actiontec MI424WR-GEN3I WAP, DD-WRT v24-sp2 (Linux 2.4.37), Linux 3.2

```

telnet 指定80端口获取web信息,半天没反应.
使用`wget -S union.58.com`获取web服务器信息,这个倒是秒出现了

```
HTTP request sent, awaiting response... 
  HTTP/1.1 200 OK
  Server: Tengine
  Date: Sat, 23 Mar 2019 09:33:13 GMT
  Content-Type: text/html;charset=UTF-8
  Transfer-Encoding: chunked
  Connection: keep-alive
  Vary: Accept-Encoding
  X-HOST: zhineng_union_v2
  Vary: Accept-Encoding
  Cache-Control: private
```


用御剑扫了后台,列出了不少目录.
然后线程开太多,虚拟机卡死了.看了眼没有什么有价值的页面.重启机子,没有继续扫描了.

## 找洞
几经尝试...放弃.
准备直接研究下别人的渗透过程,也没找到比较详细的,基本都是草草讲一下发现漏洞的关键点.

我的实际操作过程嘛...
sql注入点都找不到在哪里,.
get请求 有些形如

```
www.123.com/categories/gifts/less_flowers 
```
完全没有参数啊,和以前学习中遇到的

```
www.123.com/categories/gifts/?less=flowers
```
不一样,都不知道该怎么测试注入语句,或者说这种本来就不是能注入的地方?

返回信息也很少有直接返回数据的,多是返回编码.也没有错误回显,无法根据错误判断.
总之就是不知如何下手.
ssrf也完全没有没有发现,寻找方法是直接看有没有加载图片的地方然后看源码是不是有可控请求,haha当然没有

文件上传...完全绕不过,正常图片都难得传上去.
更多的就没有测试了.
又用awvs跑了下,没跑出什么来,开始怀疑这东西到底有用吗,又用awvs跑了学校官网试试,然后我ip被学校服务器禁了........

以上都是在主站做的尝试.

回到我最开始找的`union.58.com` 这个子站,基本没有可以输入的地方.
再按照这个流程测试下其他的子站.也就不做记录了.
成果0.

# 5173
使用 fofa找到了5173的ip
122.226.202.134


# www.xueche.com
通过fofa找到这个ip查询到了这个域名,然后多地ping这个域名返回同一个ip.
取得了真实ip:154.8.240.11
这是58旗下的一个什么站,域名完全不同了.

查看web指纹

```
root@kali:~# wget -S 122.226.202.134
--2019-03-24 05:29:11--  http://122.226.202.134/
Connecting to 122.226.202.134:80... connected.
HTTP request sent, awaiting response... 
  HTTP/1.1 301 Moved Permanently
  Server: nginx/1.1.19
  Date: Sun, 24 Mar 2019 09:29:08 GMT

```

获取操作系统信息

```
root@kali:~# nmap -O 122.226.202.134
Starting Nmap 7.70 ( https://nmap.org ) at 2019-03-24 05:32 EDT
Nmap scan report for 122.226.202.134
Host is up (0.16s latency).
Not shown: 987 closed ports
PORT     STATE    SERVICE
42/tcp   filtered nameserver
80/tcp   open     http
135/tcp  filtered msrpc
139/tcp  filtered netbios-ssn
445/tcp  filtered microsoft-ds
514/tcp  filtered shell
593/tcp  filtered http-rpc-epmap
1025/tcp filtered NFS-or-IIS
1068/tcp filtered instl_bootc
3128/tcp filtered squid-http
4444/tcp filtered krb524
5800/tcp filtered vnc-http
5900/tcp filtered vnc
Aggressive OS guesses: Actiontec MI424WR-GEN3I WAP (99%), DD-WRT v24-sp2 (Linux 2.4.37) (98%), Linux 3.2 (97%), Linux 4.4 (97%), Microsoft Windows XP SP3 or Windows 7 or Windows Server 2012 (96%), Microsoft Windows XP SP3 (96%), BlueArc Titan 2100 NAS device (91%)
No exact OS matches for host (test conditions non-ideal).

OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 107.48 seconds

```



