---
title: Google Play 无法下载应用
categories:
  - 默认
date: 2023-02-26 22:02:02
updated:
top:
tags:
description:
keywords:
comments:
image:
---
无格式迁移
<!--more-->

自从换了miui官方系统,google play就时不时无法下载了.
首先,排除干扰因素,确保能够进入google play主页,开启数据下载开关,然后下载一直转圈.
分下一下原因,再找出解决办法.

分析
先直接开启全,.局代,.理.确保所有流量都向服务器发出.
我有两批节点,一批在服务器审计处限制了.cn等域名的代,.理,暂且称之为A组.另一批没有做任何限制,可以代,.理绝大多数.cn域名称之为B组.
所以猜测google play无法下载是因为发出的请求使用了.cn的域名
抓取google play的日志发现这两个地址

googleapis.cn
services.googleapis.cn
并不是正常的

googleapis.com
解析一下ip,ip地址,并查询ip归属.
归属地为北京,北京谷翔信息技术有限公司,应该是持有google中国icp拍照的公司,但是这个ip并不能获取任何play商店的内容.天眼查显示该公司google持股50%.大概不是什么钓鱼地址.手机没有解锁,所以我就不考虑重刷框架了.

所以大致知道了googplay时不时不能下载的原。节点的路由规则很简单,且切换策略使用的url-test当节点切换到B组的时候,googleapis.cn会被代,.理服务器解析到play市场正确的ip.而当使用A组的时候会被服务器拒绝解析.或者当你使用了一些不恰当的规则让googleapis.cn不走代,.理服务器,直接国内dns解析到了这个谷翔公司的ip.

所以我们要下载就需要满足两个条件:

代,.理服务器没有把这两个域名加入审计
这两个域名通过代,.理访问
那些使用国内版固件又能下载的老哥一定是满足了这两个条件.

解决方案
更换代,.理
找一个能够回国的节点用,比如我就在规则中把这两个.cn的地址分配给B组.

刷机
群里发生这个问题的是国内固件,所以可以刷一个其他的固件,或者重装原版Google服务.

adb删除不正确的地址
可以用adb删除googlexxx.cn的xml文件.但是手机升级后肯定需要重新搞.

更改dns(没试过)
直接使用国外的dns服务应该可以解决,因为我们只需要获取正确的ip,但是这样会导致国内服务缓慢.

其他
还有什么关闭下载加速,清空数据的玄学艹作,这种一般都是没有把需要代理应用勾选完,或者节点质量差的原因.

结论
ROOT后方法就太多了，由于没有root,所以最好的还是找一个可以回国的节点,然后在规则中将

googleapis.cn
services.googleapis.cn
加入B组
除此之外,由于A组的流量多,是我的主要节点,B组是自己搭建的,落地服务器质量差,延迟奇高只是做备用的.
所以,我还需要把类似

translate.google.cn
的域名加入B组规则.
百度某些api有地域歧视,我也把他们加入了B组,使用美,.帝的ip来访问.
台,.湾无法使用百度网盘(A组有tai,.弯节点),也得使用B组.
加了一大堆规则,头疼.所以建议使用clas,.h的老哥们还是用subconvert来拼接规则方便一点.